<?php

use Skyline\Render\Context\DefaultRenderContext;
/**
 * @title WLW Projekt :: Home
 * @description WLW Projekt :: Kleinteilelager
 * @require Application
 *
 * @var DefaultRenderContext $this
 */

?>
<style>
    #tbl-material tr td.info {
        font-size: 80%;
        color: gray;
        vertical-align: middle;
    }

    #tbl-material .mat-tools {
        text-align: right;
    }
</style>
<script type="application/javascript">
    // Du kannst hier
    const SETUP = {};

    function click_btn(sender, material_id) {
        if($(sender).hasClass("mat-delete")) {
            alert("Delete Material "+material_id);
        } else {
            alert("Edit Material "+material_id);
        }
    }

    function insert_template(data) {
        if(data.hasOwnProperty("id")) {
            const id = data['id'];
            delete data['id'];

            let template = $("<tr>");
            template.html( SETUP.tpl );

            for(const e in data) {
                template.find("td.mat-"+e).text( data[e] )
            }

            template.find("button").on("click", function() {
                click_btn(this, id)
            });

            $("#tbl-material tbody").append(template);
        }
    }

    $(()=>{
        const tpl= $("#tbl-material tbody .template");
        SETUP.tpl = tpl.html();
        tpl.remove()

        setTimeout(()=>{
            insert_template({
                'id': 22,
                'name': "Mutter M4",
                "info": "Das ist ein Test",
                "lager": "Lager 35",
                "anzahl": 56
            })
        }, 2000)
    })
</script>
<div class="content">
	<h1>Material</h1>

    <table class="table table-sm table-striped table-hover" id="tbl-material">
        <thead>
        <tr>
            <th>Material</th>
            <th>Beschreibung</th>
            <th>Lagerort</th>
            <th>Bestand</th>
            <th> </th>
        </tr>
        </thead>
        <tbody>
        <tr class="template">
            <td class="mat-name">Schraube M3x15mm</td>
            <td class="mat-info info">DIN 912 Zylinderschrauben mit Innensechskant; ISO 4762 modifiziert [Norm zurückgezogen] 912</td>
            <td class="mat-lager">Lager 13</td>
            <td class="mat-anzahl">38</td>
            <td class="mat-tools">
                <button class="mat-delete btn btn-sm btn-outline-danger p-0 px-2">Löschen</button>
                <button class="mat-edit btn btn-sm btn-outline-primary p-0 px-2">Ändern</button>
            </td>
        </tr>
        </tbody>
        <tfoot >
        <tr style="background-color: #f3f4ee">
            <td colspan="100">
                <div class="row align-items-center border-top pt-1">
                    <div class="col-auto">
                        <div class="input-group input-group-sm mb-3">
                            <span class="input-group-text page-move first" data-page="1">«</span>
                            <span class="input-group-text page-move prev" data-page="1">&lt</span>
                            <input type="text" placeholder="2 / 29" style="width: 80px; flex: none" data-page="1" class="form-control text-center page-counter" aria-label="Sizing example input" aria-describedby="inputGroup-sizing-sm">
                            <span class="input-group-text page-move next" data-page="2">&gt;</span>
                            <span class="input-group-text page-move last" data-page="0">»</span>
                        </div>
                    </div>

                    <div class="col-auto">
                        <div class="input-group input-group-sm mb-3 ms-4">
                            <label class="col-form-label-sm">Datensätze pro Seite</label>
                        </div>
                    </div>

                    <div class="col-auto">
                        <div class="input-group input-group-sm mb-3">
                            <select class="form-select page-count">
                                <option selected>10</option>
                                <option>25</option>
                                <option>50</option>
                                <option>100</option>
                                <option>250</option>
                                <option>500</option>
                                <option>1000</option>
                            </select>
                        </div>
                    </div>

                    <div class="col-auto ms-auto">
                        <div class="input-group input-group-sm mb-3">
                            <label class="col-form-label-sm total-marker">0 - 0 / 0</label>
                        </div>
                    </div>
                </div>
            </td>
        </tr>
        </tfoot>
    </table>
</div>
